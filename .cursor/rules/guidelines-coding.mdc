---
description: コーディング推奨事項
globs: ["**/*.ts", "**/*.tsx"]
alwaysApply: false
---

# コーディング推奨事項

## 🛠️ 静的チェックツール推奨事項
- **ESLint type-aware設定の活用**
- **環境別TypeScript設定の使い分け**
- **自動フォーマットの活用**
- **IDE連携による効率化**

## 📊 品質向上推奨事項
- **段階的チェック実行**
- **エラー時の適切な対応**
- **チーム内ルール統一**
- **継続的品質改善**

## 📝 ファイル命名

### 推奨パターン
- **テストファイル**: `*.test.ts`、`*.spec.ts`
- **設定ファイル**: `*.config.ts`、`*.config.js`
- **型定義ファイル**: `*.d.ts`、`types.ts`

## 📦 インポート順序

### 推奨パターン
- **グループ分け**: 関連するインポートをグループ化
- **アルファベット順**: 同一グループ内ではアルファベット順
- **空行**: グループ間に空行を挿入

### 例
```typescript
import React from 'react';
import { useQuery } from '@tanstack/react-query';

import { apiRequest } from '@/lib/queryClient';
import { useAuth } from '@/hooks/useAuth';

import { Customer } from '@shared/types/common';

import { CustomerList } from './CustomerList';
import { CustomerDialog } from './CustomerDialog';
```

## 🏗️ コンポーネント設計

### 推奨パターン
- **関数宣言**: アロー関数ではなく関数宣言を使用
- **Props型定義**: interfaceで型定義
- **責務分離**: ロジックと表示の分離

### 例
```typescript
interface CustomerListProps {
  customers: Customer[];
  onEdit: (customer: Customer) => void;
  onDelete: (id: string) => void;
}

export function CustomerList({ customers, onEdit, onDelete }: CustomerListProps) {
  // コンポーネント実装
}
```

## 🔧 カスタムフック設計

### 推奨パターン
- **ロジックの再利用**: ビジネスロジックをフックに集約
- **関心の分離**: 単一責任の原則
- **メモ化**: useCallbackでメモ化

### 例
```typescript
export function useCustomers() {
  const [customers, setCustomers] = useState<Customer[]>([]);
  
  const fetchCustomers = useCallback(async () => {
    // データ取得ロジック
  }, []);
  
  return { customers, fetchCustomers };
}
```

## 📊 型定義

### 推奨パターン
- **型エイリアス**: 複雑な型は型エイリアスで定義
- **ユニオン型**: 複数の型の組み合わせ
- **ジェネリクス**: 再利用可能な型定義
- **型ガード**: 実行時の型チェック

### 推奨型定義例
- **プリミティブ型**: string、number、boolean等の基本型
- **オブジェクト型**: interfaceで構造を定義
- **配列型**: T[]またはArray<T>で要素型を明示
- **関数型**: 引数と戻り値の型を明示
- **ユニオン型**: 複数の型の組み合わせ

### 例
```typescript
interface ApiResponse<T> {
  data: T;
  success: boolean;
  message?: string;
}

export async function fetchCustomers(): Promise<ApiResponse<Customer[]>> {
  // 実装
}
```

## 🛠️ エラーハンドリング

### 推奨パターン
- **TanStack Query**: useMutation、useQueryでエラーハンドリング
- **トースト通知**: useToastフックを使用
- **バリデーション**: Zodによる厳密なバリデーション

### 例
```typescript
export function useCreateCustomer() {
  const { toast } = useToast();
  
  return useMutation({
    mutationFn: async (data: CreateCustomerData) => {
      const res = await apiRequest("POST", '/api/customers', data);
      return await res.json();
    },
    onError: (error) => {
      toast({
        title: "エラー",
        description: "顧客の作成に失敗しました",
        variant: "destructive"
      });
    }
  });
}
```

## 🌐 HTTPステータスコード

### 推奨パターン
- **202 Accepted**: 非同期処理の開始
- **204 No Content**: 成功だが返却データなし
- **409 Conflict**: リソースの競合
- **422 Unprocessable Entity**: バリデーションエラー
- **429 Too Many Requests**: レート制限

## 📏 コンポーネント分割

### 推奨基準
- **責務分離**: 単一責任の原則
- **再利用性**: 複数箇所で使用される場合は分割

### 分割例
```typescript
// 大きなコンポーネントを分割
export function CustomerManagement() {
  return (
    <div>
      <CustomerToolbar />
      <CustomerList />
      <CustomerDialog />
    </div>
  );
}
```

## 🎯 氏名フィールド

### 推奨パターン
- **フルネーム**: 姓名をまとめて管理する場合
- **ミドルネーム**: 中間名の対応
- **敬称**: 敬称の管理方法
- **国際化**: 多言語対応の氏名表示

### 例
```typescript
interface UserProfile {
  fullName: string;
  firstName?: string;
  lastName?: string;
  middleName?: string;
  title?: string; // 敬称
  locale: 'ja' | 'en';
}
```

## ✅ 実装チェックリスト

### 新機能開発時
- [ ] コードの可読性向上
- [ ] パフォーマンスの最適化
- [ ] エラーハンドリングの充実
- [ ] テストカバレッジの向上
- [ ] ドキュメントの整備

### コードレビュー時
- [ ] コードの可読性確認
- [ ] パフォーマンスへの影響確認
- [ ] セキュリティリスクの確認
- [ ] 保守性の確認
- [ ] 設計パターンの適用確認