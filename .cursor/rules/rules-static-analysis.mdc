# 静的解析必須ルール

## 🚫 絶対禁止事項

### 絶対禁止
- **ESLintチェックなしのコードコミット**
- **TypeScript型チェックエラーの放置**
- **Prettierフォーマット違反のコミット**
- **コミット前フックの無効化**
- **静的解析ツールの設定無視**

## 🔧 必須実装事項

### 必須静的解析ツール
- **ESLint**: コード品質・スタイルチェック必須
- **TypeScript**: 厳密な型チェック必須
- **Prettier**: 自動コードフォーマット必須
- **Husky + lint-staged**: コミット前チェック必須

### 必須設定ファイル
- **eslint.config.js**: ESLint設定必須
- **tsconfig.eslint.json**: ESLint用TypeScript設定必須
- **client/tsconfig.json**: クライアント用TypeScript設定必須
- **server/tsconfig.json**: サーバー用TypeScript設定必須
- **package.json**: browserslist設定必須

### 必須package.json設定
```json
{
  "scripts": {
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "typecheck": "tsc --noEmit --project tsconfig.eslint.json",
    "format": "prettier --write \"**/*.{ts,tsx,js,jsx,json,css,md}\"",
    "prepare": "husky"
  },
  "lint-staged": {
    "*.{ts,tsx,js,jsx}": ["eslint --fix"],
    "*.{json,md,css}": ["prettier --write"]
  }
}
```

## 📋 必須チェック項目

### 必須ESLintルール
- **@typescript-eslint/consistent-type-imports**: 型インポート統一必須
- **@typescript-eslint/no-floating-promises**: Promise取りこぼし防止必須
- **@typescript-eslint/no-unused-vars**: 未使用変数検出必須
- **react-hooks/rules-of-hooks**: Hooksルール違反検出必須
- **react-hooks/exhaustive-deps**: useEffect依存配列チェック必須
- **simple-import-sort/imports**: インポート自動ソート必須
- **compat/compat**: ブラウザ互換性チェック必須

### 必須TypeScript設定
- **exactOptionalPropertyTypes**: オプショナルプロパティ厳密チェック必須
- **noUncheckedIndexedAccess**: インデックスアクセス安全チェック必須
- **useUnknownInCatchVariables**: catch文型安全性必須
- **verbatimModuleSyntax**: モジュール構文厳密処理必須

### 必須コミット前チェック
- **TypeScript型チェック**: 全プロジェクト型チェック必須
- **ESLint自動修正**: 修正可能な問題の自動修正必須
- **Prettier自動フォーマット**: コードフォーマット統一必須

## 🎯 必須品質基準

### エラー許容度
- **ESLintエラー**: 0件必須
- **TypeScriptエラー**: 0件必須
- **Prettierフォーマット違反**: 0件必須
- **未使用変数**: 0件必須

### 型安全性基準
- **型定義カバレッジ**: 100%必須
- **any型使用**: 禁止（サーバー側を除く）
- **型インポート**: 型のみのインポート必須
- **厳密nullチェック**: 必須

### コード品質基準
- **インポート順序**: 自動ソート必須
- **ブラウザ互換性**: browserslist準拠必須
- **アクセシビリティ**: jsx-a11y準拠必須
- **セキュリティ**: 脆弱性0件必須

## 🔄 必須運用フロー

### 開発時必須チェック
1. **IDE連携**: ESLint/TypeScriptリアルタイムチェック必須
2. **手動実行**: `npm run lint`での品質確認必須
3. **自動修正**: `npm run lint:fix`での問題修正必須

### コミット時必須チェック
1. **型チェック**: `npm run typecheck`自動実行必須
2. **lint-staged**: ステージングファイル品質チェック必須
3. **自動修正**: 修正可能な問題の自動修正必須

### 環境別必須チェック
- **クライアント**: `npm run check:client`での型チェック必須
- **サーバー**: `npm run check:server`での型チェック必須
- **全体**: `npm run typecheck`での統合チェック必須

## ⚠️ 例外条件

### 一時的例外
- **新機能開発中**: 開発ブランチでの一時的例外（本番マージ前は必須遵守）
- **緊急修正**: セキュリティ修正時の一時的例外（24時間以内の修正必須）

### 恒久的例外
- **サーバー側**: `@typescript-eslint/no-explicit-any`の使用許可
- **設定ファイル**: `no-console`の使用許可
- **テストファイル**: 厳密な型チェックの緩和許可

## 🚨 違反時の対応

### 自動対応
- **ESLintエラー**: 自動修正可能なものは自動修正
- **フォーマット違反**: Prettierによる自動修正
- **インポート順序**: simple-import-sortによる自動修正

### 手動対応
- **型エラー**: 開発者による手動修正必須
- **セキュリティ問題**: 即座の修正必須
- **パフォーマンス問題**: 優先的な修正必須

## 📊 監視・報告

### 品質メトリクス
- **ESLintエラー数**: 日次監視
- **TypeScriptエラー数**: 日次監視
- **型カバレッジ**: 週次監視
- **セキュリティ脆弱性**: リアルタイム監視

### 品質レポート
- **週次品質レポート**: チーム共有必須
- **月次改善計画**: 継続的品質向上必須
- **四半期レビュー**: ツール・設定見直し必須