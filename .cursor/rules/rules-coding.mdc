---
description: コーディング必須ルール
globs: ["**/*.ts", "**/*.tsx", "server/**/*.ts", "client/**/*.tsx"]
alwaysApply: true
---

# コーディング必須ルール

## 🚫 絶対禁止事項

### 絶対禁止
- **any型の使用**
- **型定義なしの関数**
- **相対パスの不適切な使用**（共通型は`@shared/types/`を使用、その他は相対パス使用）
- **命名規則の不統一**

## 📝 ファイル命名必須ルール

### 必須命名規則
- **コンポーネント**: PascalCase.tsx（例: `CustomerList.tsx`）
- **ユーティリティ**: camelCase.ts（例: `dateUtils.ts`）
- **フックファイル**: `use[機能名].ts`（例: `useCustomers.ts`）

### フック命名必須ルール
- **一覧取得**: `use[機能名]s`（例: `useCustomers`, `useProjects`）
- **単体取得**: `use[機能名]`（例: `useCustomer`, `useProject`）
- **作成**: `useCreate[機能名]`（例: `useCreateCustomer`）
- **更新**: `useUpdate[機能名]`（例: `useUpdateCustomer`）
- **削除**: `useDelete[機能名]`（例: `useDeleteCustomer`）

## 📦 インポート順序必須ルール

### 必須順序
1. **React関連**: React、React DOM関連
2. **外部ライブラリ**: サードパーティライブラリ
3. **内部モジュール**: `@/`で始まる内部モジュール
4. **相対パス**: `./`や`../`で始まる相対パス

### 必須インポートパス
- **共通型**: `@shared/types/`を使用
- **その他**: 相対パスを使用

## 🏗️ コンポーネント設計必須ルール

### 必須実装パターン
- **関数宣言**: アロー関数ではなく関数宣言を使用
- **Props型定義**: interfaceで型定義
- **責務分離**: ロジックと表示の分離

## 📊 型定義必須ルール

### 必須型定義
- **関数の引数と戻り値**: 型を明示
- **interface使用**: typeよりinterfaceを使用
- **any型回避**: any型の使用を避ける
- **複雑な型**: types.tsに定義

## 🔧 Express.jsルーティング必須ルール

### 必須ルーティング順序
- **具体的なパス**: 先に定義
- **パラメータ付きルート**: 後で定義
- **サブルーター**: 具体的なパス（`/types`, `/groups`など）を先に定義し、最後に汎用パス（`/`）を定義

## 🛠️ エラーハンドリング必須ルール

### 必須実装
- **TanStack Query**: useMutation、useQueryでエラーハンドリング
- **トースト通知**: useToastフックを使用（sonnerを直接使用禁止）
- **バリデーション**: Zodによる厳密なバリデーション

## 🌐 HTTPステータスコード必須ルール

### 必須ステータスコード
- **200 OK**: 成功
- **201 Created**: 作成成功
- **400 Bad Request**: リクエストエラー
- **401 Unauthorized**: 認証エラー
- **404 Not Found**: リソースが見つからない
- **500 Internal Server Error**: サーバーエラー

## 🎯 氏名フィールド必須ルール

### 必須フィールド定義
- **firstName**: 名
- **lastName**: 姓
- **表示順序**: 「姓 名」の順序

## 📏 コンポーネント分割必須ルール

### 必須分割基準
- **300行ルール**: 300行を超える場合は必須分割
- **責務分離**: 単一責任の原則
- **再利用性**: 複数箇所で使用される場合は分割

### 300行超過時の対応
- **Container/Presentational分離**: ロジックと表示を分離
- **カスタムフック抽出**: ビジネスロジックをフックに分離
- **子コンポーネント分割**: 機能単位でコンポーネント分割

## 📅 日付・時刻表示必須ルール

### 必須表示形式
- **画面表示**: 日本時間（JST）に変換して表示必須
- **ライブラリ**: date-fnsライブラリ使用必須
- **表示フォーマット**: yyyy/MM/dd HH:mm:ss、yyyy/MM/dd形式で統一必須
- **ロケール設定**: date-fnsのjaロケールで日本語表示必須