---
description: ルール優先順位と適用範囲
alwaysApply: true
---

# ルール優先順位

## 🚨 ルール優先順位（上から下へ）

### 必須ルール（Rules）- 最優先
1. **rules-security.mdc**: セキュリティ必須ルール（最優先）
2. **rules-static-analysis.mdc**: 静的解析必須ルール（新規追加）
3. **rules-code-quality.mdc**: コード品質必須ルール（新規追加）
4. **rules-api.mdc**: API呼び出し必須ルール
5. **rules-authentication.mdc**: 認証必須ルール
6. **rules-database.mdc**: データベース必須ルール

### アーキテクチャ設計（Architecture）- 設計指針
5. **architecture-layers.mdc**: アーキテクチャ層設計
6. **architecture-backend.mdc**: バックエンド責務分離
7. **architecture-frontend.mdc**: フロントエンドアーキテクチャ設計
8. **architecture-middleware.mdc**: ミドルウェア責務分離
9. **architecture-storage.mdc**: データアクセス層責務分離
10. **architecture-shared.mdc**: 共通アーキテクチャ設計

### 推奨ガイドライン（Guidelines）- 参考
11. **guidelines-eslint.mdc**: ESLint利用ガイドライン（新規追加）
12. **guidelines-typescript.mdc**: TypeScript設定ガイドライン（新規追加）
13. **guidelines-pre-commit.mdc**: コミット前チェックガイドライン（新規追加）
14. **guidelines-coding.mdc**: コーディング推奨事項
15. **guidelines-frontend.mdc**: フロントエンド推奨事項
16. **guidelines-backend.mdc**: バックエンド推奨事項
17. **guidelines-performance.mdc**: パフォーマンス推奨事項
18. **guidelines-error-handling.mdc**: エラーハンドリング推奨事項
19. **guidelines-date-time.mdc**: 日付・時刻推奨事項

## 📋 ルール適用時の注意事項

### 基本原則
- **上位ルールが下位ルールより優先される**
- **矛盾するルールがある場合は上位ルールを採用**
- **セキュリティルールは最優先で適用**
- **新しい機能実装時は既存実装を参考にする**
- **不明な場合は既存の実装パターンに従う**

### ルール分類の使い分け

#### 必須ルール（Rules）
- **性質**: 絶対に守らなければならない
- **違反時**: エラー、警告、システムの不具合
- **例外**: 基本的に例外は認められない
- **例**: `apiRequest`の使用、認証チェック、セキュリティ対策

#### 推奨ガイドライン（Guidelines）
- **性質**: 可能な限り従うが、状況に応じて柔軟に対応可能
- **違反時**: 品質の低下、一貫性の欠如
- **例外**: 合理的な理由があれば例外を認める
- **例**: 命名規則、コンポーネント設計、エラーハンドリング

#### アーキテクチャ設計（Architecture）
- **性質**: システム全体の設計思想
- **目的**: 一貫した設計パターンの維持
- **適用**: 新機能開発時の設計指針
- **例**: 3層アーキテクチャ、責務分離、依存関係

## 🔧 実装時の適用順序

### 新機能開発時
1. **セキュリティルール**: セキュリティ要件の確認
2. **APIルール**: API呼び出しパターンの確認
3. **認証ルール**: 認証・認可の実装
4. **データベースルール**: データアクセスの実装
5. **アーキテクチャ**: 設計パターンの適用
6. **ガイドライン**: コーディング規約の適用

### トラブルシューティング時
1. **セキュリティルール**: セキュリティ問題の確認
2. **APIルール**: API呼び出し問題の確認
3. **認証ルール**: 認証問題の確認
4. **データベースルール**: データアクセス問題の確認
5. **ガイドライン**: 実装パターンの確認

## ✅ ルール遵守チェックリスト

### 必須ルール遵守
- [ ] セキュリティルールの遵守
- [ ] 静的解析ルールの遵守
- [ ] コード品質ルールの遵守
- [ ] APIルールの遵守
- [ ] 認証ルールの遵守
- [ ] データベースルールの遵守

### 推奨ガイドライン適用
- [ ] コーディングガイドラインの適用
- [ ] フロントエンドガイドラインの適用
- [ ] バックエンドガイドラインの適用
- [ ] TypeScriptガイドラインの適用

### アーキテクチャ設計適用
- [ ] アーキテクチャ層設計の適用
- [ ] バックエンド責務分離の適用
- [ ] フロントエンドアーキテクチャ設計の適用
- [ ] ミドルウェア責務分離の適用
- [ ] データアクセス層責務分離の適用
- [ ] 共通アーキテクチャ設計の適用