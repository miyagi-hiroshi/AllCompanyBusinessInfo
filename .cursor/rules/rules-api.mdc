---
description: API呼び出し必須ルール
globs: ["server/routes/**/*.ts", "client/src/hooks/**/*.ts"]
alwaysApply: true
---

# API呼び出し必須ルール

## 🚫 絶対禁止事項

### 絶対禁止
- **fetchの直接使用**
- **apiClientの直接使用**
- **統一されていないレスポンス形式**
- **エラーハンドリングなしのAPI呼び出し**

## 🔧 フロントエンド必須実装

### 必須API呼び出しパターン
- **フロントエンド**: `apiRequest`の使用は必須
- **エラーハンドリング**: 統一されたエラーハンドリング必須

### 必須レスポンス処理
- **データ形式検証**: レスポンスデータの型チェック必須
- **エラー時デフォルト値**: エラー時は安全なデフォルト値を返す必須

## 🎯 バックエンド必須実装

### 必須エンドポイント設計
- **一貫性**: 新機能追加時は既存のエンドポイントパターンに従う（例: `/api/feature-name/sub-feature`）
- **フロントエンド連携**: APIエンドポイントのパスはバックエンドとフロントエンドで完全に一致させる

### 必須レスポンス形式
- **成功時**: `{ success: true, data: result }`形式必須
- **エラー時**: `{ success: false, message: 'エラーメッセージ' }`形式必須

### レスポンス形式具体例
```typescript
// 成功レスポンス
{
  "success": true,
  "data": {
    "id": "123",
    "name": "サンプルデータ"
  }
}

// エラーレスポンス
{
  "success": false,
  "message": "リソースが見つかりません"
}

// ページネーション付きレスポンス
{
  "success": true,
  "data": {
    "items": [...],
    "total": 100,
    "page": 1,
    "limit": 20
  }
}
```