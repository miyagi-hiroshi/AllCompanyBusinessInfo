# TypeScript設定ガイドライン

## 🏗️ 設定推奨事項

### 環境別tsconfig分離
- **ESLint用**: `tsconfig.eslint.json` - 全プロジェクト型チェック
- **クライアント用**: `client/tsconfig.json` - ブラウザ専用環境
- **サーバー用**: `server/tsconfig.json` - Node.js専用環境
- **共有設定**: `tsconfig.json` - 共通設定の継承

### 厳密な型チェック設定
- **strict**: true - 厳密な型チェック有効化
- **exactOptionalPropertyTypes**: true - オプショナルプロパティの厳密チェック
- **noUncheckedIndexedAccess**: true - インデックスアクセスの安全チェック
- **useUnknownInCatchVariables**: true - catch文での型安全性向上

### パフォーマンス最適化
- **skipLibCheck**: true - ライブラリ型チェックスキップ
- **isolatedModules**: true - モジュール分離最適化
- **incremental**: true - 増分コンパイル有効化
- **tsBuildInfoFile**: ビルド情報キャッシュ設定

### IDE連携設定
- **verbatimModuleSyntax**: true - モジュール構文の厳密処理
- **moduleDetection**: "force" - モジュール検出の強制
- **baseUrl**: パス解決のベース設定
- **paths**: エイリアス設定

## 📊 型安全性推奨事項

### 厳密な型定義
- **関数の型**: 引数・戻り値の明示的型定義
- **変数の型**: 型推論を活用しつつ明示的型定義
- **オブジェクト型**: interface/typeの適切な使い分け
- **配列型**: 要素型の明示とジェネリクス活用

### 型ガードの活用
- **typeof**: プリミティブ型の判定
- **instanceof**: オブジェクト型の判定
- **in演算子**: プロパティ存在の判定
- **カスタム型ガード**: 複雑な型判定の実装

### ジェネリクスの適切な利用
- **関数ジェネリクス**: 型安全な関数実装
- **クラスジェネリクス**: 型安全なクラス実装
- **制約**: extendsによる型制約
- **デフォルト型**: 型パラメータのデフォルト設定

### 型エイリアスの活用
- **複雑な型**: 可読性向上のための型エイリアス
- **共用型**: 複数箇所で使用する型の共通化
- **条件型**: 条件に応じた型の選択
- **テンプレート型**: 文字列型の動的生成

## 🔧 最適化推奨事項

### 型解決の高速化
- **プロジェクト参照**: 大規模プロジェクトでの型解決最適化
- **複合プロジェクト**: 複数プロジェクトの効率的な管理
- **型チェック分離**: ビルドと型チェックの分離
- **キャッシュ活用**: 型情報のキャッシュによる高速化

### 不要な型チェックの除外
- **node_modules**: 外部ライブラリの型チェック除外
- **生成ファイル**: 自動生成ファイルの型チェック除外
- **テストファイル**: テスト専用の型チェック設定
- **設定ファイル**: 設定専用の型チェック設定

### 環境別最適化
- **クライアント**: ブラウザ環境に最適化された型設定
- **サーバー**: Node.js環境に最適化された型設定
- **ESLint**: 型情報を活用したESLint設定
- **ビルド**: 本番ビルドに最適化された型設定

### ビルド時間短縮
- **増分コンパイル**: 変更部分のみの再コンパイル
- **並列処理**: 複数ファイルの並列型チェック
- **キャッシュ**: 型情報の永続化キャッシュ
- **最適化**: 不要な型チェックの除外

## 📋 推奨設定例

### ルートtsconfig.json（共通設定）
```json
{
  "compilerOptions": {
    "incremental": true,
    "tsBuildInfoFile": "./node_modules/typescript/tsbuildinfo",
    "module": "ESNext",
    "moduleResolution": "Bundler",
    "strict": true,
    "target": "ES2022",
    "esModuleInterop": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./client/src/*"],
      "@shared/*": ["./shared/*"]
    },
    
    "exactOptionalPropertyTypes": true,
    "noUncheckedIndexedAccess": true,
    "useUnknownInCatchVariables": true,
    "noImplicitOverride": true,
    
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "isolatedModules": true,
    "skipLibCheck": true
  }
}
```

### tsconfig.eslint.json（ESLint専用）
```json
{
  "extends": "./tsconfig.json",
  "include": [
    "client/src/**/*",
    "server/**/*",
    "shared/**/*",
    "scripts/**/*",
    "vite.config.ts",
    "eslint.config.js"
  ],
  "compilerOptions": {
    "noEmit": true,
    "allowJs": true,
    "checkJs": false,
    "jsx": "preserve",
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "types": ["vite/client"],
    "skipLibCheck": true,
    "isolatedModules": true
  }
}
```

### client/tsconfig.json（クライアント専用）
```json
{
  "extends": "../tsconfig.json",
  "include": ["src/**/*"],
  "exclude": ["node_modules", "build", "dist", "**/*.test.ts"],
  "compilerOptions": {
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "jsx": "react-jsx",
    "noEmit": true,
    "types": ["vite/client"],
    "baseUrl": "./src",
    "paths": {
      "@/*": ["./*"],
      "@shared/*": ["../../shared/*"]
    }
  }
}
```

### server/tsconfig.json（サーバー専用）
```json
{
  "extends": "../tsconfig.json",
  "include": ["**/*"],
  "exclude": ["node_modules", "build", "dist", "**/*.test.ts"],
  "compilerOptions": {
    "lib": ["ES2022"],
    "noEmit": true,
    "types": ["node"],
    "moduleResolution": "node"
  }
}
```

## 🎯 型定義推奨パターン

### 基本型定義
```typescript
// 関数の型定義
function calculateTotal(items: Item[]): number {
  return items.reduce((sum, item) => sum + item.price, 0);
}

// オブジェクトの型定義
interface User {
  id: string;
  name: string;
  email: string;
  createdAt: Date;
}

// 配列の型定義
type UserList = User[];
type StringArray = string[];
```

### 高度な型定義
```typescript
// ジェネリクス
interface ApiResponse<T> {
  success: boolean;
  data: T;
  message?: string;
}

// 条件型
type NonNullable<T> = T extends null | undefined ? never : T;

// テンプレート型
type EventName<T extends string> = `on${Capitalize<T>}`;

// ユーティリティ型
type Partial<T> = { [P in keyof T]?: T[P] };
```

### 型ガード
```typescript
// 型ガード関数
function isString(value: unknown): value is string {
  return typeof value === 'string';
}

// カスタム型ガード
function isUser(obj: unknown): obj is User {
  return obj !== null && 
         typeof obj === 'object' && 
         'id' in obj && 
         'name' in obj;
}

// 使用例
function processValue(value: unknown) {
  if (isString(value)) {
    // valueはstring型として扱える
    console.log(value.toUpperCase());
  }
}
```

## 📊 パフォーマンス最適化

### 型チェック最適化
- **プロジェクト分離**: 環境別の型チェック分離
- **キャッシュ活用**: 型情報の永続化キャッシュ
- **並列処理**: 複数ファイルの並列型チェック
- **増分コンパイル**: 変更部分のみの再チェック

### ビルド最適化
- **型チェック分離**: ビルドと型チェックの分離
- **不要チェック除外**: 不要な型チェックの除外
- **最適化設定**: 本番ビルド用の最適化
- **Tree Shaking**: 未使用コードの除去

### 開発体験最適化
- **IDE連携**: リアルタイム型チェック
- **エラー表示**: 分かりやすいエラーメッセージ
- **自動補完**: 型情報を活用した自動補完
- **リファクタリング**: 型安全なリファクタリング

## 🔄 継続的改善

### 定期的な設定見直し
- **月次レビュー**: 型チェック設定の効果確認
- **四半期見直し**: 新機能・設定の検討
- **年次更新**: TypeScript・関連ツールのバージョンアップ

### 型定義の改善
- **型安全性向上**: より厳密な型定義の実装
- **型の再利用**: 共通型定義の整理・統合
- **型ドキュメント**: 型定義のドキュメント化
- **型テスト**: 型定義のテスト実装

### パフォーマンス改善
- **型チェック時間**: 型チェック時間の短縮
- **ビルド時間**: ビルド時間の短縮
- **メモリ使用量**: メモリ使用量の最適化
- **キャッシュ効率**: キャッシュの効率化

### チーム教育
- **型定義研修**: TypeScript型定義の教育
- **ベストプラクティス**: 型定義のベストプラクティス共有
- **コードレビュー**: 型定義のコードレビュー強化
- **継続学習**: 最新TypeScript機能の学習